<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>七並べ</title>
<script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
<style>
#hand { margin: 20px; }
.card { display: inline-block; width: 60px; height: 90px; border: 1px solid #000; text-align:center; line-height:90px; margin: 3px; cursor:pointer; }
#table { margin: 20px; }
.suit { margin: 10px 0; }
</style>
</head>
<body>
<h1>オンライン七並べ</h1>
<div id="table">
    <div class="suit" id="hearts"></div>
    <div class="suit" id="spades"></div>
    <div class="suit" id="diamonds"></div>
    <div class="suit" id="clubs"></div>
</div>

<h3>あなたの手札</h3>
<div id="hand"></div>

<script>
const socket = io();

const username = "{{ username }}";
const room = "room1";  // 簡易版: 固定ルーム

socket.emit("join_game", {username, room});

socket.on("update_hands", hands => {
    const myHand = hands[username];
    const handDiv = document.getElementById("hand");
    handDiv.innerHTML = "";
    myHand.forEach(card => {
        const c = document.createElement("div");
        c.className = "card";
        c.textContent = card;
        c.onclick = () => {
            socket.emit("play_card", {username, room, card});
        }
        handDiv.appendChild(c);
    });
});

socket.on("card_played", data => {
    // 場の更新
    for (const suit in data.table) {
        const suitDiv = document.getElementById(suit.toLowerCase());
        suitDiv.textContent = data.table[suit].join(" ");
    }
});
</script>
</body>
</html>
